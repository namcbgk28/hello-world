<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
<head>
    <title>Edit Employee</title>
    <h:outputStylesheet library="css" name="style.css" />
</head>
<body>
    <div class="container">
        <h1>Edit Employee</h1>
        
        <h:outputText value="#{employeeBean.message}" rendered="#{employeeBean.message != null}" 
                     styleClass="message" />
        
        <h:panelGroup rendered="#{employeeBean.selectedEmployee == null}">
            <div class="no-data">
                <p>No employee selected for editing.</p>
                <h:commandButton value="Back to List" action="index" 
                               styleClass="btn btn-primary" immediate="true" />
            </div>
        </h:panelGroup>
        
        <h:panelGroup rendered="#{employeeBean.selectedEmployee != null}">
            <div class="employee-form">
                <h3>Editing: #{employeeBean.selectedEmployee.employeeName}</h3>
                
                <h:form>
                    <div class="form-group">
                        <label>Employee Code:</label>
                        <h:inputText value="#{employeeBean.newEmployee.employeeCode}" 
                                   placeholder="Enter employee code" 
                                   disabled="true" 
                                   styleClass="disabled-field" />
                        <small class="form-text">Employee code cannot be changed</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Employee Name:</label>
                        <h:inputText value="#{employeeBean.newEmployee.employeeName}" 
                                   placeholder="Enter employee name" 
                                   required="true" 
                                   requiredMessage="Employee name is required" />
                        <h:message for="employeeName" styleClass="error-message" />
                    </div>
                    
                    <div class="form-group">
                        <label>Age:</label>
                        <h:inputText value="#{employeeBean.newEmployee.employeeAge}" 
                                   placeholder="Enter age" 
                                   required="true" 
                                   requiredMessage="Age is required" />
                        <h:message for="employeeAge" styleClass="error-message" />
                    </div>
                    
                    <div class="form-group">
                        <label>Date of Birth:</label>
                        <h:inputText value="#{employeeBean.newEmployee.dateOfBirth}" 
                                   placeholder="yyyy-MM-dd"
                                   required="true" 
                                   requiredMessage="Date of birth is required">
                            <f:convertDateTime pattern="yyyy-MM-dd" />
                        </h:inputText>
                        <h:message for="dateOfBirth" styleClass="error-message" />
                    </div>
                    
                    <div class="form-actions">
                        <h:commandButton value="Update Employee" action="#{employeeBean.saveEmployee()}" 
                                       styleClass="btn btn-success" />
                        <h:commandButton value="Cancel" action="#{employeeBean.cancelAction()}" 
                                       styleClass="btn btn-secondary" />
                        <h:commandButton value="Back to List" action="index" 
                                       styleClass="btn btn-info" immediate="true" />
                    </div>
                </h:form>
            </div>
            
            <div class="current-info">
                <h3>Current Information:</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <strong>Code:</strong> #{employeeBean.selectedEmployee.employeeCode}
                    </div>
                    <div class="info-item">
                        <strong>Name:</strong> #{employeeBean.selectedEmployee.employeeName}
                    </div>
                    <div class="info-item">
                        <strong>Age:</strong> #{employeeBean.selectedEmployee.employeeAge}
                    </div>
                    <div class="info-item">
                        <strong>Date of Birth:</strong> #{employeeBean.selectedEmployee.dateOfBirth}
                    </div>
                </div>
            </div>
        </h:panelGroup>
    </div>
    
    <script type="text/javascript">
        // Load employee data when page loads
        window.onload = function() {
            var urlParams = new URLSearchParams(window.location.search);
            var employeeCode = urlParams.get('code');
            if (employeeCode) {
                // Call JSF method to load employee
                var form = document.createElement('form');
                form.method = 'POST';
                form.action = 'edit-employee.xhtml';
                
                var input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'employeeCode';
                input.value = employeeCode;
                
                form.appendChild(input);
                document.body.appendChild(form);
                
                // Submit form to load employee data
                form.submit();
            }
        };
    </script>
</body>
</html>
